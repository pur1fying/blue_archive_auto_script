import{_ as i,c as a,o as t,ah as l}from"./chunks/framework.DaDXF32t.js";const e="/assets/example_skill_active_template.riIoevEI.png",n="/assets/example_skill_l_inactive_template.D_yYydJY.png",h="/assets/example_skill_r_inactive_template.od0blpm1.png",y=JSON.parse('{"title":"技能 (Skill)","description":"","frontmatter":{},"headers":[],"relativePath":"develop_doc/script/auto_fight_skill_update.md","filePath":"develop_doc/script/auto_fight_skill_update.md","lastUpdated":1754125252000}'),k={name:"develop_doc/script/auto_fight_skill_update.md"};function p(d,s,r,o,E,c){return t(),a("div",null,s[0]||(s[0]=[l(`<h1 id="技能-skill" tabindex="-1">技能 (Skill) <a class="header-anchor" href="#技能-skill" aria-label="Permalink to “技能 (Skill)”">​</a></h1><h2 id="简介-introduction" tabindex="-1">简介 (Introduction) <a class="header-anchor" href="#简介-introduction" aria-label="Permalink to “简介 (Introduction)”">​</a></h2><ol><li><p>本文主要考虑如何在图像中高效的提取以下信息:</p><p><code>a.</code> 每个槽<code>Slot</code>的技能名称</p><p><code>b.</code> 技能是否可用<code>Active</code></p><p><code>c.</code> 每个槽的技能费用<code>Cost</code>是多少</p></li><li><p><code>a</code> 与 <code>b</code> --&gt; <a href="#skillnameupdater"><code>SkillNameUpdater</code></a></p></li><li><p><code>c</code> --&gt; <a href="#skillcostupdater"><code>SkillCostUpdater</code></a></p></li></ol><h2 id="skillnameupdater" tabindex="-1"><code>SkillNameUpdater</code> <a class="header-anchor" href="#skillnameupdater" aria-label="Permalink to “SkillNameUpdater”">​</a></h2><h2 id="skillcostupdater" tabindex="-1"><code>SkillCostUpdater</code> <a class="header-anchor" href="#skillcostupdater" aria-label="Permalink to “SkillCostUpdater”">​</a></h2><h2 id="相关配置" tabindex="-1">相关配置 <a class="header-anchor" href="#相关配置" aria-label="Permalink to “相关配置”">​</a></h2><h2 id="static-config" tabindex="-1">static_config <a class="header-anchor" href="#static-config" aria-label="Permalink to “static_config”">​</a></h2><p><code>&quot;/BAAS/auto_fight/Skill&quot;</code> 字段下</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;Skill&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;slot&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;center&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">883</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">621</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">985</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">621</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1087</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">621</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;match_template_regions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">839</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">594</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">982</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">670</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">940</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">594</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1032</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">670</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1041</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">594</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1133</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">670</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;cost_ocr_regions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">839</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">594</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">982</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">670</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">940</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">594</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1032</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">670</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1041</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">594</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1133</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">670</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;templates&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;Ui&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;active&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;active&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;inactive&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;l_inactive&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;r_inactive&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="slot-center" tabindex="-1"><code>/slot/center</code> <a class="header-anchor" href="#slot-center" aria-label="Permalink to “/slot/center”">​</a></h3><ul><li><strong>type</strong>: <code>List</code></li><li><strong>length</strong>: <code>3</code><ul><li><strong>elements</strong>: <ul><li><strong>type</strong>: <code>List[int]</code></li><li><strong>length</strong>: <code>2</code></li></ul></li></ul></li><li><strong>description</strong> : 每个技能槽中心</li><li><strong>note</strong> : 释放技能时选定技能的坐标</li></ul><h3 id="slot-match-template-regions" tabindex="-1"><code>/slot/match_template_regions</code> <a class="header-anchor" href="#slot-match-template-regions" aria-label="Permalink to “/slot/match_template_regions”">​</a></h3><ul><li><strong>type</strong>: <code>List</code></li><li><strong>length</strong>: <code>3</code><ul><li><strong>elements</strong>: <ul><li><strong>type</strong>: <code>List[int]</code></li><li><strong>length</strong>: <code>4</code></li></ul></li></ul></li><li><strong>description</strong> : 每个技能槽的模板匹配区域</li><li><strong>note</strong> : 该区域内的图像会被提取出来, 用于与<a href="#templates"><code>技能模板</code></a>进行匹配</li></ul><h3 id="slot-cost-ocr-regions" tabindex="-1"><code>/slot/cost_ocr_regions</code> <a class="header-anchor" href="#slot-cost-ocr-regions" aria-label="Permalink to “/slot/cost_ocr_regions”">​</a></h3><ul><li><strong>type</strong>: <code>List</code></li><li><strong>length</strong>: <code>3</code><ul><li><strong>elements</strong>: <ul><li><strong>type</strong>: <code>List[int]</code></li><li><strong>length</strong>: <code>4</code></li></ul></li></ul></li><li><strong>description</strong> : 每个技能槽的<code>cost</code>文字识别区域</li></ul><h3 id="templates" tabindex="-1"><code>/templates</code> <a class="header-anchor" href="#templates" aria-label="Permalink to “/templates”">​</a></h3><ul><li><strong>type</strong>: <code>Dict</code></li><li><strong>description</strong> : 技能槽的模板</li><li><strong>note</strong>: <ol><li><code>active</code> : 技能可使用时模版, 默认含一个值<code>active</code></li><li><code>inactive</code> : 技能不可使用时模版, 默认含两个值<code>l_inactive</code>和<code>r_inactive</code></li></ol></li><li><strong>example</strong>: 默认的三个模板图像 <ol><li><code>active</code><img src="`+e+'" alt="active"></li><li><code>l_inactive</code><img src="'+n+'" alt="l_inactive"></li><li><code>r_inactive</code><img src="'+h+`" alt="r_inactive"></li></ol></li></ul><h2 id="screenshot-data" tabindex="-1">screenshot_data <a class="header-anchor" href="#screenshot-data" aria-label="Permalink to “screenshot_data”">​</a></h2><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> slot_skill</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::optional</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;int&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         index;    </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::optional</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;int&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         cost;     </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::optional</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;bool&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        is_active;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> template_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    cv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::Mat template;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::vector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;double&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> estimated_match_template_time_cost;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> skill_template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::string name;    </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::vector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">template_info</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> active_templates;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::vector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">template_info</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> inactive_templates;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> screenshot_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::vector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">slot_skill</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  skills;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::vector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::vector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;int&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> each_slot_possible_templates; </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::vector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">skill_template</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> all_possible_skills;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    uint32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> skill_cost_update_flag </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> 0b</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> slot_count;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="struct-slot-skill" tabindex="-1">struct <code>slot_skill</code> <a class="header-anchor" href="#struct-slot-skill" aria-label="Permalink to “struct slot_skill”">​</a></h2><p>记录运行时一个槽检查状态的数据</p><h3 id="index" tabindex="-1"><code>index</code> <a class="header-anchor" href="#index" aria-label="Permalink to “index”">​</a></h3><ul><li><strong>type</strong>: <code>std::optional&lt;int&gt;</code></li><li><strong>description</strong>: 识别到的技能在<a href="#all-possible-skills"><code>all_possible_skills</code></a>中的索引</li></ul><h3 id="cost" tabindex="-1"><code>cost</code> <a class="header-anchor" href="#cost" aria-label="Permalink to “cost”">​</a></h3><ul><li><strong>type</strong>: <code>std::optional&lt;int&gt;</code></li><li><strong>description</strong>: 识别到的技能槽的<code>cost</code>值</li></ul><h3 id="is-active" tabindex="-1"><code>is_active</code> <a class="header-anchor" href="#is-active" aria-label="Permalink to “is_active”">​</a></h3><ul><li><strong>type</strong>: <code>std::optional&lt;bool&gt;</code></li><li><strong>description</strong>: 识别到的技能是否可用</li></ul><h2 id="struct-template-info" tabindex="-1">struct <code>template_info</code> <a class="header-anchor" href="#struct-template-info" aria-label="Permalink to “struct template_info”">​</a></h2><p>记录技能槽的模板图像数据, 以及模板匹配的估计时间</p><h3 id="template" tabindex="-1"><code>template</code> <a class="header-anchor" href="#template" aria-label="Permalink to “template”">​</a></h3><ul><li><strong>type</strong>: <code>cv::Mat</code></li><li><strong>description</strong>: 模板图像</li></ul><h3 id="estimated-match-template-time-cost" tabindex="-1"><code>estimated_match_template_time_cost</code> <a class="header-anchor" href="#estimated-match-template-time-cost" aria-label="Permalink to “estimated_match_template_time_cost”">​</a></h3><ul><li><strong>type</strong>: <code>std::vector&lt;double&gt;</code></li><li><strong>length</strong>: <a href="#skills"><code>skills.size()</code></a></li><li><strong>description</strong>: 在每个槽的模版匹配的估计时间</li></ul><h2 id="struct-skill-template" tabindex="-1">struct <code>skill_template</code> <a class="header-anchor" href="#struct-skill-template" aria-label="Permalink to “struct skill_template”">​</a></h2><p>记录技能槽的模板图像数据</p><h3 id="name" tabindex="-1"><code>name</code> <a class="header-anchor" href="#name" aria-label="Permalink to “name”">​</a></h3><ul><li><strong>type</strong>: <code>std::string</code></li><li><strong>description</strong>: 技能名称</li></ul><h3 id="active-templates" tabindex="-1"><code>active_templates</code> <a class="header-anchor" href="#active-templates" aria-label="Permalink to “active_templates”">​</a></h3><ul><li><strong>type</strong>: <code>std::vector&lt;template_info&gt;</code></li><li><strong>description</strong>: 技能可用模板</li></ul><h3 id="inactive-templates" tabindex="-1"><code>inactive_templates</code> <a class="header-anchor" href="#inactive-templates" aria-label="Permalink to “inactive_templates”">​</a></h3><ul><li><strong>type</strong>: <code>std::vector&lt;template_info&gt;</code></li><li><strong>description</strong>: 技能不可用模板</li></ul><h2 id="struct-screenshot-data" tabindex="-1">struct <code>screenshot_data</code> <a class="header-anchor" href="#struct-screenshot-data" aria-label="Permalink to “struct screenshot_data”">​</a></h2><h3 id="skills" tabindex="-1"><code>skills</code> <a class="header-anchor" href="#skills" aria-label="Permalink to “skills”">​</a></h3><ul><li><strong>type</strong>: <code>std::vector&lt;slot_skill&gt;</code></li><li><strong>description</strong>: 记录运行时每个技能槽的状态数据</li></ul><h3 id="each-slot-possible-templates" tabindex="-1"><code>each_slot_possible_templates</code> <a class="header-anchor" href="#each-slot-possible-templates" aria-label="Permalink to “each_slot_possible_templates”">​</a></h3><ul><li><strong>type</strong>: <code>std::vector&lt;std::vector&lt;int&gt;&gt;</code></li><li><strong>description</strong>: 每个槽可能的技能的技能在<a href="#all-possible-skills"><code>all_possible_skills</code></a>中的索引, 用于模板匹配</li></ul><h3 id="all-possible-skills" tabindex="-1"><code>all_possible_skills</code> <a class="header-anchor" href="#all-possible-skills" aria-label="Permalink to “all_possible_skills”">​</a></h3><ul><li><strong>type</strong>: <code>std::vector&lt;skill_template&gt;</code></li><li><strong>description</strong>: 所有可能的技能模板</li></ul><h3 id="skill-cost-update-flag" tabindex="-1"><code>skill_cost_update_flag</code> <a class="header-anchor" href="#skill-cost-update-flag" aria-label="Permalink to “skill_cost_update_flag”">​</a></h3><ul><li><strong>type</strong>: <code>uint32_t</code></li><li><strong>description</strong>: 第i位表示第i个<a href="#skills"><code>skill</code></a>的<a href="#cost"><code>cost</code></a>需要更新</li></ul><h3 id="slot-count" tabindex="-1"><code>slot_count</code> <a class="header-anchor" href="#slot-count" aria-label="Permalink to “slot_count”">​</a></h3><ul><li><strong>type</strong>: <code>int</code></li><li><strong>description</strong>: 技能槽总数, <a href="#skills">skills</a> , <a href="#each-slot-possible-templates">each_slot_possible_templates</a>与之等长</li></ul><h2 id="skillnameupdater-1" tabindex="-1"><code>SkillNameUpdater</code> <a class="header-anchor" href="#skillnameupdater-1" aria-label="Permalink to “SkillNameUpdater”">​</a></h2><h3 id="estimated-time-cost" tabindex="-1"><code>estimated_time_cost()</code> <a class="header-anchor" href="#estimated-time-cost" aria-label="Permalink to “estimated_time_cost()”">​</a></h3><ol><li><p>模版匹配的耗时: 设模版图像的大小为 <code>x1,y1</code>, 匹配区域的大小为 <code>x2,y2</code>, 则</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">double</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t_one_match_template </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (x2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (y2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (x2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y2)</span></span></code></pre></div></li><li><p>每次<code>update()</code>需要的耗时 假设每个槽中出现的技能概率相同, 并且每个模板出现的概率也相同</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">double</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">size_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tmp_cnt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">double</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> d_tmp_cnt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data-&gt;each_slot_possible_templates.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">auto&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _template : data-&gt;each_slot_possible_templates[i]) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        tmp_cnt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data-&gt;all_possible_skills[_template].skill_active_templates.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                  data-&gt;all_possible_skills[_template].skill_inactive_templates.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    d_tmp_cnt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> double</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tmp_cnt);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data-&gt;each_slot_possible_templates[i].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); j</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">auto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _template : data-&gt;all_possible_skills[data-&gt;each_slot_possible_templates[i][j]].skill_active_templates)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            cost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _template.estimated_match_template_time_cost[i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (d_tmp_cnt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> d_tmp_cnt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">auto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _template : data-&gt;all_possible_skills[data-&gt;each_slot_possible_templates[i][j]].skill_inactive_templates)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            cost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _template.estimated_match_template_time_cost[i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (d_tmp_cnt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> d_tmp_cnt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cost</span></span></code></pre></div></li></ol><h2 id="skillcostupdater-1" tabindex="-1"><code>SkillCostUpdater</code> <a class="header-anchor" href="#skillcostupdater-1" aria-label="Permalink to “SkillCostUpdater”">​</a></h2><h3 id="estimated-time-cost-1" tabindex="-1"><code>estimated_time_cost()</code> <a class="header-anchor" href="#estimated-time-cost-1" aria-label="Permalink to “estimated_time_cost()”">​</a></h3><ol><li>每更新一个技能的cost需要进行一次ocr, 平均耗时为 <code>更新技能数 * 一次ocr平均耗时</code></li><li>code<div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> double</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BAASUtil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">count_bit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data-&gt;skill_cost_update_flag)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">e</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div></li></ol>`,58)]))}const _=i(k,[["render",p]]);export{y as __pageData,_ as default};
